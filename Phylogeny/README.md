# ReadMe

This page describes how each scripts in `scripts` folder are used to conducting the pipeline to building the species tree of the seed plant backbone from sequence data to the tree.  

  All aligned and cleaned sequences are located at `./data/mafft_clean_trimal_aln/`. `raxml-ng_launch.sh` launch either `raxml-ng1T.sbatch` (one thread) or `raxml-ng-NT.sbatch` (N threads) to run analysis using [RAxML Next Generation](https://github.com/amkozlov/raxml-ng), depends on the alignment size and computation resources request (if more threads or memory needed, then it will use `raxml-ng-NT.sbatch` submit a job to SLURM).  

  After the RAxML analysis has done, run `astral.sh` will collect all the best ML trees of each of 351 gene trees, and using `reroot_genetree_phyx_mad.R` and `mad.R` to reroot the gene tree, then run  then [ASTRAL-III](https://github.com/smirarab/ASTRAL) to summarise gene tree as the species tree.  
  

+ `raxml-ng_launch.sh`  
	_Main script submit RAxML-ng jobs to SLURM. It has three features: 1). checking [alignment size](./data/mafft_clean_trimal_aln/) and grap information about computational resources; 2). raxml-ng use `AutoMRE` option [use MRE-based bootstrap convergence criterion, otherwise will run 1000 replicates as default; 3). distinguish SLURM jobs based on how many threads needed._  
	- `raxml-ng1T.sbatch`  
		One thread SLURM job script.  
	- `raxml-ng-NT.sbatch`  
		Multiple threads SLURM job script.  
		
+ `astral.sh`  
	_ `astral.sh` will first reroot the each of [gene trees](./data/gene_tree/) generated by RAxML-ng above using either [phyx](https://github.com/FePhyFoFum/phyx) function `pxrr` or [Minimal Ancestor Deviation (MAD)](https://www.nature.com/articles/s41559-017-0193), then it will concatenate all the rerooted gene trees into one single gene tree file, then collapse any node with BS <10%, then input it into astral to infer [the species tree](./data/species_tree/Backbone_species_tree.tre).  _
	- `mad.R`  
		R script used for reroot the tree based on Minimal Ancestor Deviation.  
	- `reroot_genetree_phyx_mad.R`  
		R script used to extract Outgroup information for each gene tree then conditionally run either`pxrr` or `mad.R` for rerooting.  
	
_Last update: Fri Mar 5 2021_  
